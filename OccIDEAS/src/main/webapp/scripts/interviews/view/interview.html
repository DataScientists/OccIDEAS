<div id="interview-wrapper">

<div class="col-md-4">
    <div ng-model="data">
	    <div>{{participant.reference}}</div>
        <ul id="interviewing-{{data.showedQuestion.idNode}}" ng-if="data.interviewStarted">
            <md-toolbar >{{data.showedQuestion.name}}
            <md-button id="numId" event-focus>
            <span class="badge">{{questionheader.name}}</span>
            <span class="badge">{{data.showedQuestion.number}}</span>
            </md-button></md-toolbar>
            <div ng-if="data.showedQuestion.type == 'Q_multiple'">
	            <div ng-repeat="node in data.showedQuestion.nodes">
              		<md-checkbox ng-checked="multiExists(node, multiSelected)"
                       ng-click="multiToggle(node, multiSelected)" class="green">
                		<span ng-if="node.type!='P_freetext'">{{node.name}}</span>
					    <md-input-container ng-if="node.type=='P_freetext'" md-no-float class="md-block">
					      	<label>Free Text</label>
        			  		<input md-maxlength="30" ng-model="node.name">
        			  		<!-- <div ng-messages="node.name.$error">
          						<div ng-message="md-maxlength">The text has to be less than 30 characters long.</div>
        			  		</div> -->
					    </md-input-container>
              		</md-checkbox>
            	</div>
            </div>
            <div ng-if="data.showedQuestion.type == 'Q_frequency'" >
            	<div ng-repeat="node in data.showedQuestion.nodes">
            	<!-- <div>{{node.type}}</div> -->
		            <div ng-switch="node.type" >
	  					<div ng-switch-when="P_frequencyweeks">
	  					<md-input-container>
        					<label>Weeks</label>
        					<md-select ng-model="node.name">
          					<md-option ng-repeat="week in weeks" value="{{week}}" >
            				{{week}}
          					</md-option>
        					</md-select>
      					</md-input-container>
	  					</div>
	  					<div ng-switch-when="P_frequencyshifthours">
	  					<md-input-container>
        					<label>Hours</label>
        					<md-select ng-model="data.showedQuestion.hours">
          					<md-option ng-repeat="hour in hoursArray" value="{{hour}}" >
            				{{hour}}
          					</md-option>
        					</md-select>
        				</md-input-container>
        				<md-input-container>
        					<label>Minutes</label>
        					<md-select ng-model="data.showedQuestion.minutes">
          					<md-option ng-repeat="minute in minutesArray" value="{{minute}}" >
            				{{minute}}
          					</md-option>
        					</md-select>
      					</md-input-container>
	  					</div>
	  					<div ng-switch-when="P_frequencyhoursminute">
	  					<md-input-container>
        					<label>Hours</label>
        					<md-select ng-model="data.showedQuestion.hours">
          					<md-option ng-repeat="hour in hoursArray" value="{{hour}}" >
            				{{hour}}
          					</md-option>
        					</md-select>
        				</md-input-container>
        				<md-input-container>
        					<label>Minutes</label>
        					<md-select ng-model="data.showedQuestion.minutes">
          					<md-option ng-repeat="minute in minutesArray" value="{{minute}}" >
            				{{minute}}
          					</md-option>
        					</md-select>
      					</md-input-container>
	  					</div>
	  					<div ng-switch-default>Unknown Frequency Type:{{node.type}}</div>
					</div>
				</div>
            </div>
            <div ng-if="data.showedQuestion.type == 'Q_single' || data.showedQuestion.type == 'Q_simple'">
                <md-radio-group ng-model="data.showedQuestion.selectedAnswer" >
			      <div ng-repeat='node in data.showedQuestion.nodes' >
			        <div flex layout-align="start center" >
			          <md-radio-button flex ng-value="node"
			              class="md-primary interview-radio-button" >
			            <span ng-if="node.type!='P_freetext'">{{node.name}}</span>
					    <md-input-container ng-if="node.type=='P_freetext'" md-no-float class="md-block">
					      	<label>Free Text</label>
        			  		<input md-maxlength="30" ng-model="node.name">
        			  		<div ng-messages="node.name.$error">
          						<div ng-message="md-maxlength">The text has to be less than 30 characters long.</div>
        			  		</div>
					    </md-input-container>
			          </md-radio-button>
			          
			        </div>
			      </div>
            </div>
            
            <md-button ng-click="saveAnswerQuestion(data.showedQuestion)" class="md-fab md-raised">       
                <span>NEXT</span>
            </md-button>
        </ul>
        <div ng-if="!data.interviewStarted">
        	<md-input-container md-no-float class="md-block">
				<label>Reference Number</label>
        		<input md-maxlength="8" minlength="8" required ng-model="data.referenceNumber" placeholder="H___-___" ng-pattern="refNoPattern" type="text">
        		<div ng-messages="data.referenceNumber.$error">
          			<div ng-message="required">This is required!</div>
      				<div ng-message="md-maxlength">That's too long!</div>
      				<div ng-message="minlength">That's too short!</div>
                    <div ng-message="pattern">The correct format is H___-___</div>
        		</div>
			</md-input-container>
            <md-button ng-click="startInterview(data)" class="md-fab md-raised ">
                <span>START</span>
            </md-button>
        </div>
        
    </div>
    <div ng-if="data.interviewEnded">
    	<p>The interview in now complete</p>
    	
    	
    </div>
    
</div>
<div class="col-md-8 moduleInterview" id="interview-question-list" >
	<div ui-tree="" id="tree-root1_$index" ng-repeat="modules in interview.modules>
		<div class="angular-ui-tree">
			<div class="tree-node">
				<span class="M_Interview {{interviewIntro.active ? 'highlight':''}}">
<!-- 				{{interview.module.name}} -->
					{{modules.name}}
<!-- 				{{participant.interviews.module.name}}{{participant.interviews.fragment.name}}</span> -->
				</span>
				<div>
						<div ng-repeat="qa in modules.questionsAsked">
<!--     				<div ng-repeat="qa in activeInterview.questionsAsked"> -->
    					<div class="tree-node-content Q_interviewresult">
    					<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   			<span class="badge">{{qa.number}}</span>
                		</div>  
    					<span class="glyphicon glyphicon-edit" style="margin-top: 5px;margin-left:2px;" aria-hidden="true" 
	    							ng-click="vm.editQuestion(interviewIntro,qa.question)"></span>
	    				<span ng-if="qa.question.type.indexOf('multi') > -1" class="badge-multi">Multi</span>
    					<span id="{{'IntResult'+qa.idNode}}" >{{ qa.name }}
    					</span>  					
    					</div>
    					<div class="tree-node-content P_interviewresult" ng-repeat="as in qa.answers">
    						<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   				<span class="badge">{{as.number}}</span>
                			</div>
    						<span id="{{'IntResult'+as.idNode}}" >{{as.name }}
    						</span>
    					</div>
    				</div>
  				</div>
			</div>
		</div>
		<div ui-tree="" id="tree-root2_$index" ng-repeat="interviewModule in interviewIntro.interviews ">
		<div class="angular-ui-tree">
			<div class="tree-node">
				<span class="M_Interview {{interviewModule.active ? 'highlight':''}}">
				{{interviewModule.module.name}}{{interviewModule.fragment.name}}</span>
				<div>
    				<div ng-if="((qa.question.type!='Q_linkedmodule') && (qa.question.type!='Q_linkedajsm'))" 
    				    ng-repeat="qa in interviewModule.questionsAsked | qaFilter:0 | orderBy:'question.number' ">
    					<div class="tree-node-content Q_interviewresult" ng-if="!qa.multiAnswers">
    					<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   			<span class="badge">{{qa.question.number}}</span>
                		</div>  
    					<span class="glyphicon glyphicon-edit" style="margin-top: 5px;margin-left:2px;" aria-hidden="true" 
	    							ng-click="vm.editQuestion(interviewModule,qa.question)"></span>
	    				<span ng-if="qa.question.type.indexOf('multi') > -1" class="badge-multi">Multi</span>
    					<span id="{{'IntResult'+qa.question.idNode}}" >{{ qa.question.name }}
	    					
    					</span>  					
    					</div>
    					<div class="tree-node-content P_interviewresult">
    						<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   				<span class="badge">{{qa.possibleAnswer.number}}</span>
                			</div>
    						<span id="{{'IntResult'+qa.possibleAnswer.idNode}}" >{{qa.interviewQuestionAnswerFreetext }}
    						</span>
    					</div>
    				</div>
  				</div>
			</div>
		</div>
		<div ui-tree="" id="tree-root3_$index" ng-repeat="interviewAJSM in interviewModule.interviews ">
		<div class="angular-ui-tree">
			<div class="tree-node">
				<span class="M_Interview {{interviewAJSM.active ? 'highlight':''}}">
				{{interviewAJSM.module.name}}{{interviewAJSM.fragment.name}}</span>
				<div>
    				<div ng-if="((qa.question.type!='Q_linkedmodule') && (qa.question.type!='Q_linkedajsm'))" 
    				    ng-repeat="qa in interviewAJSM.questionsAsked | qaFilter:0 | orderBy:'question.number' ">
    					<div class="tree-node-content Q_interviewresult" ng-if="!qa.multiAnswers">
    					<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   			<span class="badge">{{qa.question.number}}</span>
                		</div>  
    					<span class="glyphicon glyphicon-edit" style="margin-top: 5px;margin-left:2px;" aria-hidden="true" 
	    							ng-click="vm.editQuestion(interviewAJSM,qa.question)"></span>
	    				<span ng-if="qa.question.type.indexOf('multi') > -1" class="badge-multi">Multi</span>
    					<span id="{{'IntResult'+qa.question.idNode}}" >{{ qa.question.name }}
	    					
    					</span>  					
    					</div>
    					<div class="tree-node-content P_interviewresult">
    						<div class="form-group pull-left" style="margin-top: 5px;margin-left: -15px;">
                   				<span class="badge">{{qa.possibleAnswer.number}}</span>
                			</div>
    						<span id="{{'IntResult'+qa.possibleAnswer.idNode}}" >{{qa.interviewQuestionAnswerFreetext }}
    						</span>
    					</div>
    				</div>
  				</div>
			</div>
		</div>
		</div>
		</div>
	</div>
	<div>
	
	</div>
</div>
</div> 
<ng-include src="'scripts/interviews/partials/intTemplate.html'"></ng-include>